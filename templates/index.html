<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNN visulization</title>
    <link href="{{url_for('static', filename = 'style.css')}}" rel="stylesheet">
</head>

<body>
    <div class="all">
      <div class="main">
        <div class="allContent">
            <div class="sidebar">
                <div class="container2">
                    <div class="logo">
                        <img src= {{url_for('static', filename = '/images/design/logo.png')}} alt="Cnn Visualization">
                    </div>
                    <div class="ourModels">
                        <h2>Our Models</h2>
                        <form action="/submit" onsubmit="check()" enctype="multipart/form-data" method="post">
                          <div class="select">
                            <select class="classic" name="model">
                                <option value="inception_dogs_cats">Inception Model</option>
                                <option value="vgg16_RPS">VGG16 Model</option>
                            </select>
                            <label  for="image_file" class="custom-file-upload">
                              Upload Image
                              <input type="file" accept="image/*" name="image_file" id="image_file" class="inputfile" style="display: none;" />
                            </label>                            
                          </div>
                        <input onmouseover="check()" class="submit" disabled="true" type="submit" value="Next" />
                        </form>
                        <p class='error'></p>
    
                    </div>
                    <div class="or">
                        <p>Or</p>
                    </div>
                    <div class="yourModel">
                        <h2>Upload Your Own Model</h2>
                        <p class="UploadModel">Upload Your Model</p>
                    </div>
                </div>
            </div>
            <div class="rightSide">
                <div class="container">
                    <h1>Visualize  Feature Maps Produced By CNN Layers</h1>
                    <p>This web application enables you to use some demo deep learning models or upload your own and an input image then it provides a comprehensive visualization of the output generated by each layer of the Convolutional Neural Network (CNN). This functionality aids you as a data scientist to grasp the inner workings of your model, and what features it highlights.</p>
                    <div class="descriprionModels">
                        <h2>We provide two distinct models for your exploration are:</h2>
                        <p class="modelDescription"><span>Model 1: </span>BLa bla and blabla Visualize  Feature Maps Produced By CNN Layers Visualize  Feature Maps Pr yes Visualize  Feature Maps Pr  as asd Visualize  Feature Maps Pr  Feature Maps.</p>
                        <p class="modelDescription last"><span>Model 2: </span>BLa bla and blabla Visualize  Feature Maps Produced By CNN Layers Visualize  Feature Maps Pr yes Visualize  Feature Maps Pr  as asd Visualize  Feature Maps Pr  Feature Maps.</p>
                        <h2 class="noteTitle">Use your own model:</h2>
                        <p class="note"><span>Note: BLa bla and blabla Visualize  Feature Maps Produced By CNN Layers Visualize  Feature Maps Pr yes Visualize  Feature Maps Pr  as asd Visualize  Feature Maps Pr  Feature Maps.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="uploadingModel">
      <div class="headerPopup">
        <img  class="close" src= {{url_for('static', filename = '/images/design/closeBtn.png')}} alt="close buttun">
      </div>
      <div class="contentPopup">
        <p>
          Upload your model, File Supported: .h5
        </p>
        <form method="POST" action="/upload" enctype="multipart/form-data" target="upload_iframe">
          <div class="drop_box">
            <input type="file" accept=".h5" id="upload" hidden/>
            <label for="upload">Upload</label>
          </div>
        </form>
        
      </div>
    </div>
    <div class="uploadingImage">
      <div class="headerPopup">
        <img  class="close2" src= {{url_for('static', filename = '/images/design/closeBtn.png')}} alt="close buttun">
      </div>
      <div id="response"></div>
      <div class="contentPopup">
        <p>
          Upload your Image
        </p>
        <form method="POST" action="/Visualization" enctype="multipart/form-data" target="upload_iframe">
          <div class="drop_box">
            <input type="file" accept="image/*" name="image2" id="image2" hidden/>
            <label for="image2" style="cursor: pointer;">Click to Upload Image</label>
            <input class="submit"  type="submit" value="Start Visualization">
        </div>
        </form>
      </div>
    </div>

    <script>
      var element = document.querySelector(".UploadModel");
      var all = document.querySelector(".all");
      var element2 = document.querySelector(".uploadingModel");
      var closeIcon = document.querySelector(".close");
      var closeIcon2 = document.querySelector(".close2");
      var imageform = document.querySelector(".uploadingImage");
      var imagefile = document.getElementById('image_file');
      var errorP = document.querySelector(".error");

      function check(){
         if(imagefile.value == ""){
          errorP.innerHTML = "Please upload the image";
         }else{
          const submit = document.querySelector(".submit");
          submit.disabled = false;
          errorP.innerHTML = "";
         }
        
      }

      if (element) {
        element.onclick = function() {
          element2.classList.add("visible");
          all.classList.add("allblack");
        
      }
      if (closeIcon2) {
        closeIcon2.onclick = function() {
          imageform.classList.remove("visible2");
          all.classList.remove("allblack");

        };          
      };
      if (closeIcon) {
        closeIcon.onclick = function() {
          element2.classList.remove("visible");
          all.classList.remove("allblack");

        };          
      };
    }
    </script>
  <script>
  
  function uploadModel() {
    const modelFileInput = document.getElementById("upload");
    const modelFile = modelFileInput.files[0];

    if (modelFile) {
        const formData = new FormData();
        formData.append("model_file", modelFile);

        fetch("/upload", {
            method: "POST",
            body: formData,
        })
        .then(response => response.text())
        .then(data => {
            document.getElementById("response").textContent = data;
            if(document.getElementById("response").textContent != ""){
              element2.classList.remove("visible");
              imageform.classList.add("visible2");
            }
        })
        .catch(error => {
            console.error("Error:", error);
        });
    }
  }
  document.querySelector('#upload').addEventListener("change", function () {
      uploadModel();
  });
  
 
  </script>
</body>
</html>