<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNN visulization</title>
    <link href="{{url_for('static', filename = 'style.css')}}" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="{{url_for('static', filename = 'favicon.ico')}}">

</head>

<body>
    <div class="all">
      <div class="main">
        <div class="allContent">
            <div class="sidebar" >
                <div class="container2">
                    <div class="logo">
                        <img src= {{url_for('static', filename = '/images/design/logo.png')}} alt="Cnn Visualization">
                    </div>
                    <div class="ourModels">
                        <h2>Our Models</h2>
                        <form action="/submit" onsubmit="check()" enctype="multipart/form-data" method="post">
                          <div class="select">
                            <select class="classic" name="model">
                                <option value="vgg16_RPS">VGG16 Model</option>
                                <option value="inception_dogs_cats">Inception Model</option>
                            </select>
                            <label  for="image_file" class="custom-file-upload">
                              Upload Image
                              <input type="file" accept="image/*" name="image_file" id="image_file" class="inputfile" style="display: none;" />
                            </label>                            
                          </div>
                        <input onmouseover="check()" id="submit-button" class="submit" disabled="true" type="submit" value="Next" />
                        </form>
                        <p class='error'></p>
    
                    </div>
                    <div class="or">
                        <p>Or</p>
                    </div>
                    <div class="yourModel">
                        <h2>Upload Your Own Model</h2>
                        <p class="UploadModel">Upload Your Model</p>
                    </div>
                </div>
            </div>
            <div class="rightSide" >
                <div class="container">
                    <h1>Visualize  Feature Maps Produced By CNN Layers</h1>
                    <p>This web application enables you to use some demo deep learning models or upload your own and an input image then it provides a comprehensive visualization of the output generated by each layer of the Convolutional Neural Network (CNN). This functionality aids you as a data scientist to grasp the inner workings of your model, and what features it highlights.</p>
                    <div class="descriprionModels">
                        <h2>We provide two distinct models for your exploration are:</h2>
                        <p class="modelDescription"><span>VGG16: </span>is a convolutional neural network model that's used for image recognition. This model uses it as its backbone to extract features in order to classify between  <b>Rock</b>, <b>Scissors</b> and <b>Paper</b>.</p>
                        <p class="modelDescription last"><span>Inception: </span>is a convolutional neural network model that's used for image recognition. This model uses it as its backbone to extract features in order to classify between  <b>Dogs</b> and <b>Cats</b>.</p>
                        <h2 class="noteTitle">Use your own model:</h2>
                        <p  class="note modelDescription"><span style="color:black"><b>Note</b></span> If you choose to upload your model, please ensure it is in <b>.h5</b> format.                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="uploadingModel">
      <div class="headerPopup">
        <img  class="close" src= {{url_for('static', filename = '/images/design/closeBtn.png')}} alt="close buttun">
      </div>
      <div class="contentPopup">
        <p>
          Upload your model, File Supported: .h5
        </p>
        <form method="POST" action="/upload" enctype="multipart/form-data" target="upload_iframe">
          <div class="drop_box">
            <input type="file" accept=".h5" id="upload" hidden/>
            <label for="upload">Upload</label>
          </div>
        </form>
        
      </div>
    </div>
    <div class="uploadingImage">
      <div class="headerPopup">
        <img  class="close2" src= {{url_for('static', filename = '/images/design/closeBtn.png')}} alt="close buttun">
      </div>
      <div id="response"></div>
      <div class="contentPopup">
        <form method="POST" action="/Visualization" enctype="multipart/form-data" target="upload_iframe">
          <div class="drop_box">
            <input type="file" accept="image/*" name="image2" id="image2" hidden/>
            <label class="toupload" for="image2" style="cursor: pointer; margin:0 0 20px 0;">Click to Upload Image</label>
            <input  class="submit goo" style="display:none"   type="submit" value="Start Visualization">
        </div>
        </form>
      </div>
    </div>
      <img id="logo" class="logo" src="{{url_for('static', filename = '/images/design/uploading.png')}}">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js" integrity="sha512-16esztaSRplJROstbIIdwX3N97V1+pZvV33ABoG1H2OyTttBxEGkTsoIVsiP1iaTtM8b3+hu2kB6pQ4Clr5yug==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        gsap.from(".sidebar", { duration: 0.5, x: -200, ease: "power2.out", opacity: 0 });
        gsap.from(".rightSide", { duration: 0.6, y: -200, ease: "power2.out", opacity: 0 });
        gsap.from(".rightSide .container", { duration: 0.4, opacity: 0, delay: .5 });
    });
    </script>
    <script>
      document.getElementById("submit-button").addEventListener("click", function() {
        document.querySelector(".all").style.display = "none";
        document.getElementById("logo").style.display = "block";
        document.getElementById("logo").classList.add('centered')
      });
  
    </script>
    <script>
      var toupload = document.querySelector(".toupload")
      toupload.addEventListener("click", function(){
         document.querySelector(".goo").style.display="block"


      })
    </script>

    <script>
      var element = document.querySelector(".UploadModel");
      var all = document.querySelector(".all");
      var element2 = document.querySelector(".uploadingModel");
      var closeIcon = document.querySelector(".close");
      var closeIcon2 = document.querySelector(".close2");
      var imageform = document.querySelector(".uploadingImage");
      var imagefile = document.getElementById('image_file');
      var errorP = document.querySelector(".error");

      function check(){
         if(imagefile.value == ""){
          errorP.innerHTML = "Please upload the image";
         }else{
          const submit = document.querySelector(".submit");
          submit.disabled = false;
          errorP.innerHTML = "";
         }
        
      }

      if (element) {
        element.onclick = function() {
          element2.classList.add("visible");
          all.classList.add("allblack");
        
      }
      if (closeIcon2) {
        closeIcon2.onclick = function() {
          imageform.classList.remove("visible2");
          all.classList.remove("allblack");

        };          
      };
      if (closeIcon) {
        closeIcon.onclick = function() {
          element2.classList.remove("visible");
          all.classList.remove("allblack");

        };          
      };
    }
    </script>
  <script>
  
  function uploadModel() {
    const modelFileInput = document.getElementById("upload");
    const modelFile = modelFileInput.files[0];

    if (modelFile) {
        const formData = new FormData();
        formData.append("model_file", modelFile);

        fetch("/upload", {
            method: "POST",
            body: formData,
        })
        .then(response => response.text())
        .then(data => {
            document.getElementById("response").textContent = data;
            if(document.getElementById("response").textContent != ""){
              element2.classList.remove("visible");
              imageform.classList.add("visible2");
            }
        })
        .catch(error => {
            console.error("Error:", error);
        });
    }
  }
  document.querySelector('#upload').addEventListener("change", function () {
      uploadModel();
  });
  
 
  </script>


</body>
</html>